<html>

<head>
  <meta charset="UTF-8">
  <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/fontfaceobserver/2.1.0/fontfaceobserver.js"></script> -->

  <!-- <script language="javascript" type="text/javascript" src="img/../../../../lib/p5.js"></script>
  <script language="javascript" type="text/javascript" src="img/sketch.js"></script> -->

  <!-- <link id="font" href="https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:wdth,wght@75..100,200..800&amp;display=swap" rel="stylesheet"> -->

  <style>
    body {
      padding: 0;
      margin: 0;
    }

    canvas {
      border: 1px solid #f0f0f0;
      display: block;
    }

    img {
      border: 1px solid #fff;
    }

    div {
      margin: 100px 0px;
    }
  </style>
</head>



<body>
  <script type="module">
    import p5 from '../../../src/app.js';
    const googleFont = "https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:opsz,wght@12..96,200..800&display=swap";
    let sketch = function (p) {
      let fonts;
      p.setup = async function () {
        p.createCanvas(800, 200);
        fonts = await loadGoogleFontSet(p, googleFont);
        p.textAlign(p.CENTER, p.CENTER);
        p.textSize(60);
      }

      p.draw = function () {
        p.background(255);

        const o = p.map(p.sin(p.frameCount / 20), -1, 1, 12, 96);
        const m = p.map(p.cos(p.frameCount / 20), -1, 1, 200, 800);

        p.textFont(fonts[0].name, 60, { fontVariationSettings: `"wght" ${m}, "opsz" ${o}` });
        p.text(`This is a variable font.`, 400, 100);
      };

      async function loadGoogleFontSet(p, url) {
        linkStylesheet(url);
        await document.fonts.ready; // ?
        let fonts = Array.from(document.fonts);
        let pfonts = fonts.map(f => new p5.Font(p, f));
        pfonts.forEach(pf => pf.path ??= url);
        return pfonts;
      }

      function linkStylesheet(href) {
        const link = document.createElement("link");
        link.id = "font";
        link.href = href;
        link.rel = "stylesheet";
        document.head.appendChild(link);
      }
    }

    new p5(sketch);
  </script>

</body>


</html>